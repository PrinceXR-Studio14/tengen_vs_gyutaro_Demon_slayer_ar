<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>MindAR Auto Video</title>

  <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
</head>

<body style="margin:0; overflow:hidden;">

<a-scene
  mindar-image="imageTargetSrc: targets.mind; uiScanning: true; uiError: true;"
  vr-mode-ui="enabled:false"
  device-orientation-permission-ui="enabled:true"
  renderer="colorManagement:true, physicallyCorrectLights:true">

  <a-camera position="0 0 0"></a-camera>

  <a-assets>
    <video
      id="vid"
      src="This_is_8K_HDR_Anime_Tengen_vs_Gyutaro_Fight_Scene_8K_HDR_720P.mp4"
      preload="auto"
      autoplay
      loop
      muted
      playsinline
      webkit-playsinline
      crossorigin="anonymous">
    </video>
  </a-assets>

  <a-entity id="target" mindar-image-target="targetIndex: 0">

    <a-video
      id="videoPlane"
      src="#vid"
      width="1.6"
      height="0.9"
      visible="false">
    </a-video>

  </a-entity>

</a-scene>

<script>
document.addEventListener("DOMContentLoaded", () => {

  const video = document.querySelector("#vid");
  const videoPlane = document.querySelector("#videoPlane");
  const target = document.querySelector("#target");

  video.muted = true;
  video.playsInline = true;
  video.load();

  // WHEN TARGET FOUND → SHOW & PLAY
  target.addEventListener("targetFound", async () => {
    videoPlane.setAttribute("visible", true);

    try {
      await video.play();
    } catch (e) {
      console.log("Autoplay blocked:", e);
    }
  });

  // WHEN TARGET LOST → HIDE & RESET
  target.addEventListener("targetLost", () => {
    video.pause();
    video.currentTime = 0;
    videoPlane.setAttribute("visible", false);
  });

});
</script>

</body>
</html>
